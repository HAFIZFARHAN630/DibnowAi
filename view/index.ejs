<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Dashboard</title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <meta content="" name="keywords">
    <meta content="" name="description">

    <!-- Favicon -->
    <link rel="icon" href="\images\Dib Now 16.svg" type="image/x-icon">
    
    <!-- Icon Font Stylesheet -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css" rel="stylesheet">

    <!-- Customized Bootstrap Stylesheet -->
    <link href="bootstrap.css" rel="stylesheet">
    <!-- Template Stylesheet -->
    <link href="styles.css" rel="stylesheet">

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .patient-card {
      background-color: #FDE8D4;  /* Light peach color */
      border-radius: 10px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      overflow: hidden;
    }
    .patient-card-header {
      background-color: #F57C00;  /* Orange header */
      color: white;
      padding: 10px;
      font-weight: bold;
      text-align: center;
    }
    .patient-card-body {
      padding: 20px;
      font-size: 2rem;
      font-weight: bold;
      text-align: center;
      color: #333;
    }
    #table-body tr {
  border-bottom: 0.5px solid #706868;
}



.card {
            background-color: #1e293b;
            border: none;
            border-radius: 1rem;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .chart-container {
            position: relative;
            height: 400px;
        }

        .progress-ring {
            width: 150px;
            height: 150px;
            margin: auto;
        }

        .progress-ring circle {
            fill: transparent;
            stroke-width: 10;
            transform: rotate(-90deg);
            transform-origin: 50% 50%;
        }

        .progress-ring .organic {
            stroke: #c084fc;
        }

        .progress-ring .social {
            stroke: #60a5fa;
        }

        .progress-ring .direct {
            stroke: #22d3ee;
        }

        .table-hover tbody tr:hover {
                          background-color: #2c3e50 !important; /* Darker color on hover */
                      }
                      .table tbody tr {
                          background-color: transparent !important; /* Transparent background for rows */
                      }
    </style>
</head>

<body>
        <!-- Sidebar Start -->
        <div class="sidebar pe-4 pb-3">
            <nav class="navbar">
            
                <div class="d-flex align-items-center ms-4 mb-4">
                    <a href="/Setting" class="d-flex align-items-center text-decoration-none">
                        <div class="position-relative">
                            <img class="rounded-circle" src="<%- profileImagePath %>" alt="Profile Image" style="width: 40px; height: 40px;" onerror="this.onerror=null; this.src='img/dumi img.png';">
                            <div class="bg-success rounded-circle border border-2 border-white position-absolute end-0 bottom-0 p-1"></div>
                        </div>
                        <div class="ms-3">
                            <h6 class="mb-0 text-dark"><%- firstName %></h6>
                        </div>
                    </a>
                </div>
                
                <div class="navbar-nav w-100">
                    <a href="/index" class="nav-item nav-link active"><i class="bi bi-tv"></i>Dashboard</a>
                    <% if (isAdmin) { %>
                    <a href="/admin" class="nav-item nav-link "> <i class="bi bi-people-fill"></i>All User</a> 
                    <a href="/addadmin" class="nav-item nav-link "><i class="fa-solid fa-user-tie"></i>Add Admin</a>
                    <a href="/request" class="nav-item nav-link  "><i class="fa-solid fa-code-pull-request"></i>Request</a>    
                    <a href="https://dashboard.tawk.to/#/dashboard/659fdbaf0ff6374032bedfad" class="nav-item nav-link " target="_blank" ><i class="bi bi-chat-text-fill"></i>Chat</a>

                    <% } %>
                    <% if (isUser) { %>
                    <a href="/inventory" class="nav-item nav-link  "><i class="bi bi-clipboard-data"></i>Inventory</a>
                    <a href="/repair" class="nav-item nav-link "><i class="bi bi-tools"></i>Repair</a>
                    <a href="/in_stock" class="nav-item nav-link "><i class="bi bi-shop-window"></i>In Stock</a>
                    <a href="/Clients" class="nav-item nav-link "><i class="bi bi-people"></i>Clients</a>
                    <a href="/pricing" class="nav-item nav-link"><i class="bi bi-wallet2"></i>Plans</a>
                    <a href="/sell" class="nav-item nav-link"><i class="bi bi-cash-stack"></i>Item History</a>
                    <a href="/Teams" class="nav-item nav-link"><i class="fa-solid fa-users"></i>Teams</a>
                    <a href="/Help" class="nav-item nav-link"><i class="bi bi-chat-dots"></i>Help</a>
                    <% } %>
              </div>
            </nav>
        </div>
        <!-- Sidebar End -->


        <!-- Navbar Start -->
        <%- include('./par/header.ejs') %>
        <!-- Navbar End -->
         
          
          

            <!-- Sale & Revenue Start -->
            <div class="container-fluid pt-4 px-4" style="background-color:#F3F3F9;">
                <div class="row justify-content-center">
                    <div class="col-12 col-sm-6 col-md-4 col-lg-3 mb-4">
                      <div class="patient-card position-relative" style="background-color: #E3F2FD;">
                        <div class="patient-card-header" style="background-color: #1E88E5;">Stock Products</div>
                        <div class="patient-card-body"><%= productCount %></div>
                        <i class="fa-solid fa-box position-absolute" style="font-size: 5rem; color: rgba(30, 136, 229, 0.2); bottom: 1px; right: 13px; z-index: 1;"></i>
                      </div>
                    </div>
                    <div class="col-12 col-sm-6 col-md-4 col-lg-3 mb-4">
                      <div class="patient-card position-relative" style="background-color: #F1F8E9;">
                        <div class="patient-card-header" style="background-color: #43A047;">Sales Products</div>
                        <div class="patient-card-body"><%= soldCount %></div>
                        <i class="bi bi-cart-fill position-absolute" style="font-size: 5rem; color: rgba(67, 160, 71, 0.2); bottom: -16px; right: 7px; z-index: 1;"></i>
                      </div>
                    </div>
                    <div class="col-12 col-sm-6 col-md-4 col-lg-3 mb-4">
                      <div class="patient-card position-relative" style="background-color: #FFF3E0;">
                        <div class="patient-card-header" style="background-color: #FB8C00;">Repair Products</div>
                        <div class="patient-card-body"><%= repairCount %></div>
                        <i class="bi bi-inboxes-fill position-absolute" style="font-size: 4.5rem; color: rgba(251, 140, 0, 0.2); bottom: -15px; right: 14px; z-index: 1;"></i>
                      </div>
                    </div>
                    <div class="col-12 col-sm-6 col-md-4 col-lg-3 mb-4">
                      <div class="patient-card position-relative" style="background-color: #FCE4EC; overflow: hidden; border-radius: 10px;">
                        <div class="patient-card-header text-white p-2" style="background-color: #D81B60; font-weight: bold;">Total team</div>
                        <div class="patient-card-body p-4 position-relative" style="font-size: 2rem; font-weight: bold;"><%= teamCount %></div>
                        <i class="bi bi-people-fill position-absolute" style="font-size: 6.5rem; color: rgba(216, 27, 96, 0.2); bottom: -36px; right: 10px; z-index: 1;"></i>
                      </div>
                    </div>
                  </div>
              </div>
            
       

<!-- Updated Second Row -->
<div class="container-fluid pt-4 px-4" style="background-color:#E8F5E9; padding-top: 0%;">
    <div class="row justify-content-center">
        <div class="col-12 col-sm-6 col-md-4 col-lg-3 mb-4">
            <div class="patient-card position-relative" style="background-color: #FFEBEE;">
                <div class="patient-card-header text-white" style="background-color: #D32F2F;">Pending Orders</div>
                <div class="patient-card-body"><%= pendingOrders %></div>
                <i class="bi bi-clock-fill position-absolute" style="font-size: 4.5rem; color: rgba(211, 47, 47, 0.2); bottom: -13px; right: 12px; z-index: 1;"></i>
            </div>
        </div>
        <div class="col-12 col-sm-6 col-md-4 col-lg-3 mb-4">
            <div class="patient-card position-relative" style="background-color: #E0F2F1;">
                <div class="patient-card-header text-white" style="background-color: #00796B;">Completed Repair Products</div>
                <div class="patient-card-body"><%= completedRepairs %> </div>
                <i class="bi bi-tools position-absolute" style="font-size: 4rem; color: rgba(0, 121, 107, 0.2); bottom: -8px; right: 13px; z-index: 1;"></i>
            </div>
        </div>
        <div class="col-12 col-sm-6 col-md-4 col-lg-3 mb-4">
            <div class="patient-card position-relative" style="background-color: #FFF3E0;">
                <div class="patient-card-header text-white" style="background-color: #3909d7ba;">Repair Total Sales</div>
                <div class="patient-card-body"> <%= totalSales ? totalSales : 0 %></div>
                <i class="bi bi-bar-chart-fill position-absolute" style="font-size: 4.5rem; color: rgba(245, 124, 0, 0.2); bottom: -15px; right: 14px; z-index: 1;"></i>
            </div>
        </div>
        
        <div class="col-12 col-sm-6 col-md-4 col-lg-3 mb-4">
            <div class="patient-card position-relative" style="background-color: #F3E5F5; overflow: hidden; border-radius: 10px;">
                <div class="patient-card-header text-white p-2" style="background-color: #7B1FA2; font-weight: bold;">Your Current Plan</div>
                <div class="patient-card-body p-4 position-relative" style="font-size: 2rem; font-weight: bold;"> <%= plan_name %></div>
                <i class="bi bi-layers-fill position-absolute" style="font-size: 6.5rem; color: rgba(123, 31, 162, 0.2); bottom: -36px; right: 10px; z-index: 1;"></i>
            </div>
        </div>
    </div>
</div>

            <!-- Sale & Revenue End -->


          <!-- Sales Chart Start -->
          <div class="container-fluid p-4">
            <div class="row justify-content-center">
                <!-- Website Visitors Card -->
                <div class="col-md-3 mb-4">
                    <div class="custom-card text-white text-center" style="background-color: #1b263b; border: none; border-radius: 15px; padding: 20px; height: 400px;">
                        <h5 class="mb-3">Website Visitors</h5>
                        <div class="d-flex justify-content-center align-items-center mb-3">
                            <svg width="150" height="150" class="mx-auto">
                                <circle cx="75" cy="75" r="60" stroke-dasharray="377" stroke-dashoffset="75" stroke="#4caf50" stroke-width="10" fill="none"></circle>
                                <circle cx="75" cy="75" r="50" stroke-dasharray="314" stroke-dashoffset="125" stroke="#2196f3" stroke-width="10" fill="none"></circle>
                                <circle cx="75" cy="75" r="40" stroke-dasharray="251" stroke-dashoffset="125" stroke="#00bcd4" stroke-width="10" fill="none"></circle>
                            </svg>
                        </div>
                        <h2 class="my-3">150k</h2>
                        <ul class="list-unstyled">
                            <li><span class="text-success">&#9679;</span> Organic - 80%</li>
                            <li><span class="text-white">&#9679;</span> Social - 60%</li>
                            <li><span class="text-info">&#9679;</span> Direct - 50%</li>
                        </ul>
                    </div>
                </div>
        
                <!-- Revenue by Customer Type Card -->
                <div class="col-md-9 mb-4">
                    <div class="custom-card text-white" style="background-color: #1b263b; border: none; border-radius: 15px; padding: 20px; height: 400px;">
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <h5>Revenue by Customer Type</h5>
                            <h4>240.8K <span class="badge bg-success">14.8% &#x2191;</span></h4>
                        </div>
        
                        <div class="chart-container" style="position: relative; height: 250px;">
                            <canvas id="revenueChart"></canvas>
                        </div>
        
                        <div class="mt-4 d-flex justify-content-between align-items-center">
                            <div>
                                <span class="text-purple">&#9679; Current clients</span>
                                <span class="text-white">&#9679; Subscribers</span>
                                <span class="text-info">&#9679; New customers</span>
                            </div>
                           
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
      
        <!-- Products and Completed Tasks Section -->
<div class="container-fluid p-4">
    <div class="row justify-content-center">
        <div class="col-md-3 mb-4">
            <div class="custom-card text-white" style="background-color: #1b263b; border: none; border-radius: 15px; padding: 20px; height: 400px; overflow-y: auto;"> 
                <h5 class="mb-4">Teams</h5>
             <% if (teams && teams.length > 0) { %>
             <% teams.slice(-4).reverse().forEach(team => { %>
              <div class="custom-product-item d-flex align-items-center mb-3">
               <img src="https://img.icons8.com/3d-fluency/94/user-male--v4.png" alt="user-male--v4" class="me-3" style="width: 50px; height: 50px;"/>
                <div>
                <strong><%= team.name %></strong>
                   </div>
                </div>
                <% }); %>
                 <% } else { %>
                  <p>No team members added yet.</p>
                   <% } %>
                </div>
                    </div>

        <!-- Completed Tasks Section -->
        <div class="col-md-9 mb-4">
            <div class="custom-card text-white" style="background-color: #1b263b; border: none; border-radius: 15px; padding: 20px; height: 400px;"> 
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <div><i class="bi bi-clock"></i> Completed tasks over time</div>
                    
                </div>
                <h2>257 <span style="color: #4caf50;">16.8% &#9650;</span></h2>
                <div style="position: relative; height: 250px;">
                    <canvas id="tasksChart"></canvas>
                </div>
            </div>
        </div>

    </div>
</div>

        
        <!-- Scripts -->
        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
        <script>
            const ctxRevenue = document.getElementById('revenueChart').getContext('2d');
            const revenueChart = new Chart(ctxRevenue, {
                type: 'bar',
                data: {
                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
                    datasets: [
                        { label: 'Current clients', data: [10, 30, 40, 35, 20, 25, 10, 40, 20, 10, 15, 20], backgroundColor: '#c084fc' },
                        { label: 'Subscribers', data: [15, 20, 25, 15, 10, 30, 5, 10, 15, 10, 15, 10], backgroundColor: '#60a5fa' },
                        { label: 'New customers', data: [10, 25, 25, 20, 5, 15, 5, 40, 5, 20, 15, 25], backgroundColor: '#22d3ee' }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: { beginAtZero: true, ticks: { color: '#ffffff' }, grid: { color: '#334155' } },
                        x: { ticks: { color: '#ffffff' }, grid: { display: false } }
                    },
                    plugins: { legend: { display: false } }
                }
            });
        
            const ctxTasks = document.getElementById('tasksChart').getContext('2d');
            const tasksChart = new Chart(ctxTasks, {
                type: 'line',
                data: {
                    labels: ['Jan 1', 'Jan 8', 'Jan 16', 'Jan 24', 'Jan 31', 'Feb 1', 'Feb 8', 'Feb 16', 'Feb 24'],
                    datasets: [{ label: 'Completed Tasks', data: [0, 120, 120, 300, 90, 210, 180, 230, 90], borderColor: '#00b4d8', backgroundColor: 'rgba(0, 180, 216, 0.2)', tension: 0.4, fill: true, borderWidth: 2 }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: { beginAtZero: true, ticks: { color: '#ffffff' }, grid: { color: '#334155' } },
                        x: { ticks: { color: '#ffffff' }, grid: { display: false } }
                    },
                    plugins: { legend: { display: false } }
                }
            });
        </script>
          
            <!-- Sales Chart End -->


            <!-- Recent Sales Start -->
           
            
                    <!-- Table Content -->
                    <div class="container-fluid p-4">
                        <div class="row justify-content-center">
                    
                            <!-- Repair Queue Section -->
                            <div class="col-md-6 mb-4">
                                <div class="custom-card text-white" style="background-color: #1b263b; border: none; border-radius: 15px; padding: 20px; height: 400px;">
                                    <div class="d-flex justify-content-between align-items-center mb-4">
                                        <h4 class="mb-0">Repair</h4>
                                        <div class="d-flex align-items-center">
                                            <a href="/repair" class="btn btn-action btn-success"><i class="bi bi-tools"></i> Go to Repair Customer</a>
                                                            
                                        </div>
                                    </div>
                    
                                    <div class="table-responsive" style="overflow-y: visible;">
                                        <table class="table table-hover mb-0" style="background-color: transparent;">
                                            <thead class="text-center">
                                                <tr>
                                                    <th class="text-white">Full Name</th>
                                                    <th class="text-white">Product Name</th>
                                                    <th class="text-white">Price</th>
                                                    <th class="text-white">Status</th>
                                                </tr>
                                            </thead>
                                            <tbody class="text-center">
                                                <% if (products && products.length > 0) { %>
                                                    <% products.slice(0, 6).forEach(product => { %>
                                                        <tr >
                                                            <td class="text-white"><%= product.fullName %></td>
                                                            <td class="text-white"><%= product.brand %></td>
                                                            <td class="text-white"> <%= product.Price %></td>
                                                            <td>
                                                                <button class="btn btn-sm text-white <%= product.status %>">
                                                                    <%= product.status %>
                                                                </button>
                                                            </td>
                                                        </tr>
                                                    <% }) %>
                                                <% } else { %>
                                                    <tr>
                                                        <td colspan="4" class="text-center text-white">No repair products found.</td>
                                                    </tr>
                                                <% } %>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                    
                            <!-- Recent Sales Section -->
                            <div class="col-md-6 mb-4">
                                <div class="custom-card text-white" style="background-color: #1b263b; border: none; border-radius: 15px; padding: 20px; height: 400px;">
                                    <div class="d-flex justify-content-between align-items-center mb-4">
                                        <h4 class="mb-0">Inventory</h4>
                                        <div class="d-flex align-items-center">  
                                            <a href="/inventory" class="btn btn-action btn-success"><i class="bi bi-clipboard-data"></i> Go to Inventory</a>
                                        </div>
                                    </div>
                    
                                    <div class="table-responsive" style="overflow-y: visible;">
                                        <table class="table table-hover mb-0" style="background-color: transparent;">
                                            <thead>
                                                <tr>
                                                    <th class="text-white">Image</th>
                                                    <th class="text-white">Product Name</th>
                                                    <th class="text-white">Details</th>
                                                    <th class="text-white">Sale Price</th>
                                                    <th class="text-white">Retail Price</th>
                                                </tr>
                                            </thead>
                                            <tbody class="text-center">
                                                <% if (inventory && inventory.length > 0) { %>
                                                    <% inventory.slice(0, 5).forEach(product => { %>
                                                        <tr>
                                                            <td><img src="/uploads/<%= product.device_image %>" alt="Device" style="width: 40px; height: 40px; object-fit: cover; border-radius: 5px;"></td>
                                                            <td class="text-white"><%= product.product_name %></td>
                                                            <td class="text-white text-wrap" style="word-wrap: break-word;"><%= product.gadget_problem %></td>
                                                            <td class="text-white"> <%= product.Sale_Price %></td>
                                                            <td class="text-white"> <%= product.Retail_Price %></td>
                                                        </tr>
                                                    <% }) %>
                                                <% } else { %>
                                                    <tr>
                                                        <td colspan="5" class="text-center text-white">No sales records found.</td>
                                                    </tr>
                                                <% } %>
                                            </tbody>
                                            
                                        </table>
                                    </div>
                                </div>
                            </div>
                    
                        </div>
                    </div>
                    
               
                    
     <!-- Recent Sales End -->
<!-- footer -->
<%- include('./par/footer.ejs') %>
  <!-- footer -->

</body>
  <!-- JavaScript Libraries -->
  <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="lib/tempusdominus/js/tempusdominus-bootstrap-4.min.js"></script>

  <!-- Template Javascript -->
  <script src="js/main.js"></script>
</html>