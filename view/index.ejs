<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Dashboard</title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <meta content="" name="keywords">
    <meta content="" name="description">

    <!-- Favicon -->
    <link rel="icon" href="\images\Dib Now 16.svg" type="image/x-icon">

    <!-- Icon Font Stylesheet -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css" rel="stylesheet">

    <!-- Customized Bootstrap Stylesheet -->
    <link href="bootstrap.css" rel="stylesheet">
    <!-- Template Stylesheet -->
    <link href="styles.css" rel="stylesheet">
    <!-- Tempus Dominus CSS -->
    <link href="https://cdn.jsdelivr.net/npm/tempusdominus-bootstrap-4@5.39.0/build/css/tempusdominus-bootstrap-4.min.css" rel="stylesheet">

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .patient-card {
      background-color: #FDE8D4;  /* Light peach color */
      border-radius: 10px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      overflow: hidden;
    }
    .patient-card-header {
      background-color: #F57C00;  /* Orange header */
      color: white;
      padding: 10px;
      font-weight: bold;
      text-align: center;
    }
    .patient-card-body {
      padding: 20px;
      font-size: 2rem;
      font-weight: bold;
      text-align: center;
      color: #333;
    }
    #table-body tr {
  border-bottom: 0.5px solid #706868;
}



.card {
            background-color: #1e293b;
            border: none;
            border-radius: 1rem;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .chart-container {
            position: relative;
            height: 300px;
            width: 95%;
        }

        .chart-container canvas {
            max-height: 100% !important;
        }

        .progress-ring {
            width: 150px;
            height: 150px;
            margin: auto;
        }

        .progress-ring circle {
            fill: transparent;
            stroke-width: 10;
            transform: rotate(-90deg);
            transform-origin: 50% 50%;
        }

        .progress-ring .organic {
            stroke: #c084fc;
        }

        .progress-ring .social {
            stroke: #60a5fa;
        }

        .progress-ring .direct {
            stroke: #22d3ee;
        }

        .table-hover tbody tr:hover {
                          background-color: #2c3e50 !important; /* Darker color on hover */
                      }
                      .table tbody tr {
                          background-color: transparent !important; /* Transparent background for rows */
                      }
        .cont{
            display: flex !important;
            flex-direction: column !important;
        }

        /* Modern Plan & Subscription Cards */
        .modern-card {
            background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
            border: none;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            overflow: hidden;
            position: relative;
        }

        .modern-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
        }

        .modern-card .card-header {
        background: linear-gradient(135deg, #0033cc 0%, #33ccff 100%)!important;
            color: white;
            padding: 20px;
            display: flex;
            align-items: center;
            position: relative;
            overflow: hidden;
        }

        .modern-card .card-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grain" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="25" cy="25" r="1" fill="rgba(255,255,255,0.1)"/><circle cx="75" cy="75" r="1" fill="rgba(255,255,255,0.1)"/><circle cx="50" cy="10" r="0.5" fill="rgba(255,255,255,0.05)"/><circle cx="10" cy="60" r="0.5" fill="rgba(255,255,255,0.05)"/><circle cx="90" cy="40" r="0.5" fill="rgba(255,255,255,0.05)"/></pattern></defs><rect width="100" height="100" fill="url(%23grain)"/></svg>');
            opacity: 0.3;
        }

        .modern-card .header-icon {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            position: relative;
            z-index: 1;
        }

        .modern-card .header-icon i {
            font-size: 1.5rem;
        }

        .modern-card .card-title {
            margin: 0;
            font-size: 1.3rem;
            font-weight: 600;
            position: relative;
            z-index: 1;
        }

        .modern-card .card-body {
            padding: 30px;
        }

        /* Plan Overview Section */
        .plan-overview {
            margin-bottom: 25px;
        }

        .plan-main-info {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }

        .plan-name {
            font-size: 1.8rem;
            font-weight: 700;
            color: #1a202c;
            margin: 0;
        }

        .plan-status-badge {
            position: relative;
        }

        .status-badge {
            padding: 8px 16px;
            border-radius: 25px;
            font-size: 0.85rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .status-badge.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%) !important;
            color: white;
        }

        .status-badge.expired {
            background: linear-gradient(135deg, #f56565, #e53e3e);
            color: white;
        }

        .status-badge.pending {
            background: linear-gradient(135deg, #ed8936, #dd6b20);
            color: white;
        }

        .status-badge.paid {
            background: linear-gradient(135deg, #4299e1, #3182ce);
            color: white;
        }

        .status-badge.unknown {
            background: linear-gradient(135deg, #a0aec0, #718096);
            color: white;
        }

        .plan-expiry {
            display: flex;
            align-items: center;
            gap: 8px;
            color: #64748b;
            font-size: 0.9rem;
        }

        .plan-expiry i {
            color: #667eea;
        }

        /* Plan Details Grid */
        .plan-details-grid {
            display: grid;
            gap: 15px;
        }

        .detail-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid #e2e8f0;
        }

        .detail-row:last-child {
            border-bottom: none;
        }

        .detail-label {
            display: flex;
            align-items: center;
            gap: 8px;
            color: #64748b;
            font-weight: 500;
        }

        .detail-label i {
            color: #667eea;
            width: 16px;
        }

        .detail-value {
            font-weight: 600;
            color: #1a202c;
        }

        .value-badge {
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .value-badge.success {
            background: #c6f6d5;
            color: #22543d;
        }

        .value-badge.danger {
            background: #fed7d7;
            color: #742a2a;
        }

        .value-badge.warning {
            background: #feebc8;
            color: #744210;
        }

        .value-badge.info {
            background: #bee3f8;
            color: #2a4365;
        }

        .value-badge.secondary {
            background: #e2e8f0;
            color: #4a5568;
        }

        .description {
            font-size: 0.9rem;
            color: #64748b;
            font-weight: 400;
        }

        /* No Plan State */
        .no-plan-state {
            text-align: center;
            padding: 40px 20px;
        }

        .no-plan-icon {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: linear-gradient(135deg, #fed7d7, #feb2b2);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
        }

        .no-plan-icon i {
            font-size: 2rem;
            color: #e53e3e;
        }

        .no-plan-state h4 {
            color: #1a202c;
            margin-bottom: 10px;
        }

        .no-plan-state p {
            color: #64748b;
        }

        /* Subscription Status */
        .subscription-status {
            display: flex;
            align-items: center;
            gap: 20px;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
        }

        .subscription-status .status-icon {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .subscription-status .status-content h4 {
            margin: 0 0 5px 0;
            font-size: 1.2rem;
        }

        .subscription-status .status-content p {
            margin: 0;
            color: #64748b;
        }

        .subscription-status.active-unpaid {
            background: linear-gradient(135deg, #fff5cd, #fde68a);
        }

        .subscription-status.active-unpaid .status-icon {
            background: #f59e0b;
        }

        .subscription-status.active-unpaid .status-icon i {
            color: white;
        }

        .subscription-status.active-unpaid .status-content h4 {
            color: #92400e;
        }

        .subscription-status.expired {
            background: linear-gradient(135deg, #fecaca, #fca5a5);
        }

        .subscription-status.expired .status-icon {
            background: #ef4444;
        }

        .subscription-status.expired .status-icon i {
            color: white;
        }

        .subscription-status.expired .status-content h4 {
            color: #7f1d1d;
        }

        .subscription-status.active-valid {
            background: linear-gradient(135deg, #d1fae5, #a7f3d0);
        }

        .subscription-status.active-valid .status-icon {
            background: #10b981;
        }

        .subscription-status.active-valid .status-icon i {
            color: white;
        }

        .subscription-status.active-valid .status-content h4 {
            color: #065f46;
        }

        .subscription-status.pending {
            background: linear-gradient(135deg, #fef3c7, #fde68a);
        }

        .subscription-status.pending .status-icon {
            background: #f59e0b;
        }

        .subscription-status.pending .status-icon i {
            color: white;
        }

        .subscription-status.pending .status-content h4 {
            color: #92400e;
        }

        /* No Subscription State */
        .no-subscription-state {
            text-align: center;
            padding: 40px 20px;
        }

        .no-subscription-icon {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: linear-gradient(135deg, #e0e7ff, #c7d2fe);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
        }

        .no-subscription-icon i {
            font-size: 2rem;
            color: #6366f1;
        }

        .no-subscription-state h4 {
            color: #1a202c;
            margin-bottom: 10px;
        }

        .no-subscription-state p {
            color: #64748b;
        }

        .choose-plan-btn {
            display: inline-block;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 14px 32px;
            border-radius: 30px;
            text-decoration: none;
            font-weight: 600;
            font-size: 1.1rem;
            transition: all 0.3s ease;
            margin-top: 20px;
            min-width: 200px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
            border: 2px solid transparent;
            position: relative;
            overflow: hidden;
        }

        .choose-plan-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s;
        }

        .choose-plan-btn:hover::before {
            left: 100%;
        }

        .choose-plan-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
            color: white;
            text-decoration: none;
            border-color: rgba(255, 255, 255, 0.3);
        }

        /* Equal height cards - Enhanced */
        .cards-container {
            display: flex;
            gap: 20px;
            align-items: stretch;
            margin-bottom: 20px;
        }

        .plan-card-container,
        .subscription-card-container {
            flex: 1;
            min-width: 0;
            display: flex;
            flex-direction: column;
        }

        .plan-card-container .modern-card,
        .subscription-card-container .modern-card {
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        .plan-card-container .modern-card .card-body,
        .subscription-card-container .modern-card .card-body {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }

        /* Ensure consistent card heights */
        .modern-card {
            min-height: 100%;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .modern-card .card-body {
                padding: 20px;
            }

            .cards-container {
                flex-direction: column;
                gap: 15px;
            }

            .plan-main-info {
                flex-direction: column;
                gap: 15px;
                align-items: flex-start;
            }

            .plan-name {
                font-size: 1.5rem;
            }

            .subscription-status {
                flex-direction: column;
                text-align: center;
                gap: 15px;
            }

            .subscription-status .status-icon {
                width: 50px;
                height: 50px;
            }

            .detail-row {
                flex-direction: column;
                align-items: flex-start;
                gap: 5px;
            }

            .detail-label {
                font-size: 0.9rem;
            }
        }
    </style>
</head>

<body>
        <%- include('./par/sidebar.ejs') %>


        <!-- Navbar Start -->
        <%- include('./par/header.ejs') %>
        <!-- Navbar End -->



            <!-- Sale & Revenue Start -->
            <div class="container-fluid pt-4 px-4" style="background-color:#F3F3F9;">
                <a href="/in_stock">
                <div class="row justify-content-center">
                    <div class="col-12 col-sm-6 col-md-4 col-lg-3 mb-4">
                      <div class="patient-card position-relative" style="background-color: #E3F2FD;">
                        <div class="patient-card-header" style="background-color: #1E88E5;">Stock Products</div>
                        <div class="patient-card-body"><%= productCount %></div>
                        <i class="fa-solid fa-box position-absolute" style="font-size: 5rem; color: rgba(30, 136, 229, 0.2); bottom: 1px; right: 13px; z-index: 1;"></i>
                    </a> 
                    </div>
                    </div>
                    <div class="col-12 col-sm-6 col-md-4 col-lg-3 mb-4">
                        <a href="/sell">
                      <div class="patient-card position-relative" style="background-color: #F1F8E9;">
                        <div class="patient-card-header" style="background-color: #43A047;">Sales Products</div>
                        <div class="patient-card-body"><%= soldCount %></div>
                        <i class="bi bi-cart-fill position-absolute" style="font-size: 5rem; color: rgba(67, 160, 71, 0.2); bottom: -16px; right: 7px; z-index: 1;"></i>
                    </a>
                    </div>
                    </div>
                    <div class="col-12 col-sm-6 col-md-4 col-lg-3 mb-4">
                        <a href="/repair">
                      <div class="patient-card position-relative" style="background-color: #FFF3E0;">
                        <div class="patient-card-header" style="background-color: #FB8C00;">Repair Products</div>
                        <div class="patient-card-body"><%= repairCount %></div>
                        <i class="bi bi-inboxes-fill position-absolute" style="font-size: 4.5rem; color: rgba(251, 140, 0, 0.2); bottom: -15px; right: 14px; z-index: 1;"></i>
                      </a>
                    </div>
                    </div>
                    <div class="col-12 col-sm-6 col-md-4 col-lg-3 mb-4">
                        <a href="/Teams">
                      <div class="patient-card position-relative" style="background-color: #FCE4EC; overflow: hidden; border-radius: 10px;">
                        <div class="patient-card-header text-white p-2" style="background-color: #D81B60; font-weight: bold;">Total team</div>
                        <div class="patient-card-body p-4 position-relative" style="font-size: 2rem; font-weight: bold;"><%= teamCount %></div>
                        <i class="bi bi-people-fill position-absolute" style="font-size: 6.5rem; color: rgba(216, 27, 96, 0.2); bottom: -36px; right: 10px; z-index: 1;"></i>
                        </a>
                    </div>
                    </div>
                  </div>
              </div>



        <!-- Updated Second Row -->
        <div class="container-fluid pt-4 px-4" style="background-color:#E8F5E9; padding-top: 0%;">
            <div class="row justify-content-center">
                <a href="/inventory">
                <div class="col-12 col-sm-6 col-md-4 col-lg-3 mb-4">
                    <div class="patient-card position-relative" style="background-color: #FFEBEE;">
                        <div class="patient-card-header text-white" style="background-color: #D32F2F;">Pending Orders</div>
                        <div class="patient-card-body"><%= pendingOrders %></div>
                        <i class="bi bi-clock-fill position-absolute" style="font-size: 4.5rem; color: rgba(211, 47, 47, 0.2); bottom: -13px; right: 12px; z-index: 1;"></i>
                        </a>
                    </div>
                </div>
                <div class="col-12 col-sm-6 col-md-4 col-lg-3 mb-4">
                    <a href="/repair">
                    <div class="patient-card position-relative" style="background-color: #E0F2F1;">
                        <div class="patient-card-header text-white" style="background-color: #00796B;">Completed Repair Products</div>
                        <div class="patient-card-body"><%= completedRepairs %> </div>
                        <i class="bi bi-tools position-absolute" style="font-size: 4rem; color: rgba(0, 121, 107, 0.2); bottom: -8px; right: 13px; z-index: 1;"></i>
                        </a>
                    </div>
                </div>
                <div class="col-12 col-sm-6 col-md-4 col-lg-3 mb-4">
                    <a href="/repair">
                    <div class="patient-card position-relative" style="background-color: #FFF3E0;">
                        <div class="patient-card-header text-white" style="background-color: #3909d7ba;">Repair Total Sales</div>
                        <div class="patient-card-body"> <%= totalSales ? totalSales : 0 %></div>
                        <i class="bi bi-bar-chart-fill position-absolute" style="font-size: 4.5rem; color: rgba(245, 124, 0, 0.2); bottom: -15px; right: 14px; z-index: 1;"></i>
                  </a>
                    </div>
                </div>

                <div class="col-12 col-sm-6 col-md-4 col-lg-3 mb-4">
                    <a href="/pricing"></a>
                    <div class="patient-card position-relative" style="background-color: #F3E5F5; overflow: hidden; border-radius: 10px;">
                        <div class="patient-card-header text-white p-2" style="background-color: #7B1FA2; font-weight: bold;">Your Current Plan</div>
                        <div class="patient-card-body p-4 position-relative" style="font-size: 2rem; font-weight: bold;"> <%= plan_name %></div>
                        <i class="bi bi-layers-fill position-absolute" style="font-size: 6.5rem; color: rgba(123, 31, 162, 0.2); bottom: -36px; right: 10px; z-index: 1;"></i>
                    </div>
                </div>

                <!-- User Count Cards - Admin Only -->
                <% if (isAdmin) { %>
                <div class="col-12 col-sm-6 col-md-4 col-lg-3 mb-4">
                    <a href="/admin">
                    <div class="patient-card position-relative" style="background-color: #E8F5E8; overflow: hidden; border-radius: 10px;">
                        <div class="patient-card-header text-white p-2" style="background-color: #2E7D32; font-weight: bold;">All Users</div>
                        <div class="patient-card-body p-4 position-relative" style="font-size: 2rem; font-weight: bold;"> <%= totalUsers || 0 %></div>
                        <i class="bi bi-people-fill position-absolute" style="font-size: 6.5rem; color: rgba(46, 125, 50, 0.2); bottom: -36px; right: 10px; z-index: 1;"></i>
                        </a>
                    </div>
                </div>

                <div class="col-12 col-sm-6 col-md-4 col-lg-3 mb-4">
                    <a href="/admin/active-users">
                    <div class="patient-card position-relative" style="background-color: #E3F2FD; overflow: hidden; border-radius: 10px;">
                        <div class="patient-card-header text-white p-2" style="background-color: #1565C0; font-weight: bold;">Active Users</div>
                        <div class="patient-card-body p-4 position-relative" style="font-size: 2rem; font-weight: bold;"> <%= activeUsers || 0 %></div>
                        <i class="bi bi-person-check-fill position-absolute" style="font-size: 6.5rem; color: rgba(21, 101, 192, 0.2); bottom: -36px; right: 10px; z-index: 1;"></i>
                        </a>
                    </div>
                </div>
                
                <div class="col-12 col-sm-6 col-md-4 col-lg-3 mb-4">
                    <a href="/admin/expired-users">
                    <div class="patient-card position-relative" style="background-color: #FFEBEE; overflow: hidden; border-radius: 10px;">
                        <div class="patient-card-header text-white p-2" style="background-color: #C62828; font-weight: bold;">Expired Users</div>
                        <div class="patient-card-body p-4 position-relative" style="font-size: 2rem; font-weight: bold;"> <%= expiredUsers || 0 %></div>
                        <i class="bi bi-person-x-fill position-absolute" style="font-size: 6.5rem; color: rgba(198, 40, 40, 0.2); bottom: -36px; right: 10px; z-index: 1;"></i>
                    </a>
                    </div>
                </div>


                <% } %>
                </div>
        </div>

        <!-- Enhanced Plan Status & Subscription Cards -->
        <% if (isUser) { %>
        <div class="container-fluid mt-4">
            <div class="cards-container">
                <!-- Plan Status Card -->
                <div class="plan-card-container">
                    <div class="plan-card modern-card">
                        <div class="card-header">
                            <div class="header-icon">
                                <i class="bi bi-star-fill"></i>
                            </div>
                            <h5 class="card-title">Plan Status</h5>
                        </div>
                        <div class="card-body">
                            <% if (userPlan && userPlan.planName) { %>
                                <div class="plan-overview">
                                    <div class="plan-main-info">
                                        <h3 class="plan-name"><%= userPlan.planName %></h3>
                                        <div class="plan-status-badge">
                                            <% if (userPlan.status === 'Active') { %>
                                                <span class="status-badge active">
                                                    <i class="bi bi-check-circle-fill"></i>
                                                    Active
                                                </span>
                                            <% } else if (userPlan.status === 'Expired') { %>
                                                <span class="status-badge expired">
                                                    <i class="bi bi-x-circle-fill"></i>
                                                    Expired
                                                </span>
                                            <% } else if (userPlan.status === 'Pending') { %>
                                                <span class="status-badge pending">
                                                    <i class="bi bi-clock-fill"></i>
                                                    Pending
                                                </span>
                                            <% } else if (userPlan.status === 'Paid') { %>
                                                <span class="status-badge paid">
                                                    <i class="bi bi-check-circle-fill"></i>
                                                    Paid
                                                </span>
                                            <% } else { %>
                                                <span class="status-badge unknown">
                                                    <i class="bi bi-question-circle-fill"></i>
                                                    <%= userPlan.status %>
                                                </span>
                                            <% } %>
                                        </div>
                                    </div>
                                    <div class="plan-expiry">
                                        <i class="bi bi-calendar-event"></i>
                                        <span>Expires: <%= userPlan.expiryDate ? new Date(userPlan.expiryDate).toLocaleDateString() : 'No expiry date' %></span>
                                    </div>
                                </div>

                                <!-- Plan Details Grid -->
                                <div class="plan-details-grid">
                                    <div class="detail-row">
                                        <div class="detail-label">
                                            <i class="bi bi-tag"></i>
                                            <span>Plan Name</span>
                                        </div>
                                        <div class="detail-value"><%= userPlan.planName %></div>
                                    </div>
                                    <div class="detail-row">
                                        <div class="detail-label">
                                            <i class="bi bi-activity"></i>
                                            <span>Status</span>
                                        </div>
                                        <div class="detail-value">
                                            <% if (userPlan.status === 'Active') { %>
                                                <span class="value-badge success">Active</span>
                                            <% } else if (userPlan.status === 'Expired') { %>
                                                <span class="value-badge danger">Expired</span>
                                            <% } else if (userPlan.status === 'Pending') { %>
                                                <span class="value-badge warning">Pending</span>
                                            <% } else if (userPlan.status === 'Paid') { %>
                                                <span class="value-badge info">Paid</span>
                                            <% } else { %>
                                                <span class="value-badge secondary"><%= userPlan.status %></span>
                                            <% } %>
                                        </div>
                                    </div>
                                    <div class="detail-row">
                                        <div class="detail-label">
                                            <i class="bi bi-receipt"></i>
                                            <span>Invoice Status</span>
                                        </div>
                                        <div class="detail-value">
                                            <% if (userPlan.invoiceStatus === 'Paid') { %>
                                                <span class="value-badge success">Paid</span>
                                            <% } else { %>
                                                <span class="value-badge warning">Unpaid</span>
                                            <% } %>
                                        </div>
                                    </div>
                                    <div class="detail-row">
                                        <div class="detail-label">
                                            <i class="bi bi-calendar-plus"></i>
                                            <span>Start Date</span>
                                        </div>
                                        <div class="detail-value"><%= new Date(userPlan.startDate || userPlan.createdAt).toLocaleDateString() %></div>
                                    </div>
                                    <div class="detail-row">
                                        <div class="detail-label">
                                            <i class="bi bi-calendar-x"></i>
                                            <span>Expiry Date</span>
                                        </div>
                                        <div class="detail-value"><%= userPlan.expiryDate ? new Date(userPlan.expiryDate).toLocaleDateString() : 'No expiry date' %></div>
                                    </div>
                                    <div class="detail-row">
                                        <div class="detail-label">
                                            <i class="bi bi-cash"></i>
                                            <span>Amount</span>
                                        </div>
                                        <div class="detail-value">Â£<%= userPlan.amount || 0 %></div>
                                    </div>
                                    <% if (userPlan.description) { %>
                                    <div class="detail-row">
                                        <div class="detail-label">
                                            <i class="bi bi-info-circle"></i>
                                            <span>Description</span>
                                        </div>
                                        <div class="detail-value description"><%= userPlan.description %></div>
                                    </div>
                                    <% } %>
                                </div>
                            <% } else { %>
                                <div class="no-plan-state">
                                    <div class="no-plan-icon">
                                        <i class="bi bi-exclamation-triangle"></i>
                                    </div>
                                    <h4>No Plan Assigned</h4>
                                    <p>Contact your administrator for plan assignment</p>
                                </div>
                            <% } %>
                        </div>
                    </div>
                </div>

                <!-- Subscription Status Card -->
                <div class="subscription-card-container">
                    <div class="subscription-card modern-card">
                        <div class="card-header">
                            <div class="header-icon">
                                <i class="bi bi-credit-card"></i>
                            </div>
                            <h5 class="card-title">Subscription Status</h5>
                        </div>
                        <div class="card-body">
                            <% if (subscription && subscription.status === 'active') { %>
                                <% if (subscription.invoice_status === 'unpaid') { %>
                                    <div class="subscription-status active-unpaid">
                                        <div class="status-icon">
                                            <i class="bi bi-exclamation-triangle"></i>
                                        </div>
                                        <div class="status-content">
                                            <h4>Active + Unpaid</h4>
                                            <p>Please complete your payment to continue</p>
                                        </div>
                                    </div>
                                <% } else if (subscription.invoice_status === 'paid') { %>
                                    <% const now = new Date(); %>
                                    <% const expiryDate = new Date(subscription.expiryDate); %>
                                    <% if (now > expiryDate) { %>
                                        <div class="subscription-status expired">
                                            <div class="status-icon">
                                                <i class="bi bi-x-circle"></i>
                                            </div>
                                            <div class="status-content">
                                                <h4>Active + Paid + Expired</h4>
                                                <p>Your subscription has expired. Please renew.</p>
                                            </div>
                                        </div>
                                    <% } else { %>
                                        <div class="subscription-status active-valid">
                                            <div class="status-icon">
                                                <i class="bi bi-check-circle"></i>
                                            </div>
                                            <div class="status-content">
                                                <h4>Active + Paid + Valid</h4>
                                                <p>Expires: <%= expiryDate.toLocaleDateString() %></p>
                                            </div>
                                        </div>
                                    <% } %>
                                <% } %>
                            <% } else if (subscription && subscription.status === 'expired') { %>
                                <div class="subscription-status expired">
                                    <div class="status-icon">
                                        <i class="bi bi-x-circle"></i>
                                    </div>
                                    <div class="status-content">
                                        <h4>Subscription Expired</h4>
                                        <p>Your subscription has expired</p>
                                    </div>
                                </div>
                            <% } else if (subscription && subscription.status === 'pending') { %>
                                <div class="subscription-status pending">
                                    <div class="status-icon">
                                        <i class="bi bi-clock"></i>
                                    </div>
                                    <div class="status-content">
                                        <h4>Payment Pending</h4>
                                        <p>Your payment is under review</p>
                                    </div>
                                </div>
                            <% } else { %>
                                <div class="no-subscription-state">
                                    <div class="no-subscription-icon">
                                        <i class="bi bi-credit-card"></i>
                                    </div>
                                    <h4>No Active Subscription</h4>
                                    <p><a href="/pricing" class="choose-plan-btn">Choose a Plan</a></p>
                                </div>
                            <% } %>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <% } %>



            <!-- Sale & Revenue End -->

            <!-- Quick Actions Section -->
             <% if (isUser) { %>
            <div class="container-fluid px-4 py-3" style="background: linear-gradient(135deg, #0033cc 0%, #33ccff 100%);; margin: 20px 0; border-radius: 15px; box-shadow: 0 8px 32px rgba(31, 38, 135, 0.37);">
              <div class="quick-actions">
                <div class="d-flex align-items-center mb-4">
                  <i class="bi bi-lightning-charge-fill me-3" style="font-size: 1.5rem; color: #fff;"></i>
                  <h3 class="section-title mb-0" style="color: #fff; font-weight: 600; font-size: 1.4rem;">Quick Actions</h3>
                </div>
                <div class="actions-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 15px;">
                  <a href="/prayer" class="action-item" style="background: rgba(255, 255, 255, 0.15); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 12px; padding: 20px 15px; text-decoration: none; transition: all 0.3s ease; text-align: center;">
                    <div class="action-icon mb-2">
                      <i class="bi bi-sun" style="font-size: 2rem; color: #FFE55C;"></i>
                    </div>
                    <p class="action-label mb-0" style="color: #fff; font-weight: 500; font-size: 0.9rem;">Prayer</p>
                  </a>

                  <a href="/quran" class="action-item" style="background: rgba(255, 255, 255, 0.15); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 12px; padding: 20px 15px; text-decoration: none; transition: all 0.3s ease; text-align: center;">
                    <div class="action-icon mb-2">
                      <i class="bi bi-book" style="font-size: 2rem; color: #4ECDC4;"></i>
                    </div>
                    <p class="action-label mb-0" style="color: #fff; font-weight: 500; font-size: 0.9rem;">Quran</p>
                  </a>

                  <a href="/tasbeeh" class="action-item" style="background: rgba(255, 255, 255, 0.15); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 12px; padding: 20px 15px; text-decoration: none; transition: all 0.3s ease; text-align: center;">
                    <div class="action-icon mb-2">
                      <i class="bi bi-circle-fill" style="font-size: 2rem; color: #45B7D1;"></i>
                    </div>
                    <p class="action-label mb-0" style="color: #fff; font-weight: 500; font-size: 0.9rem;">Tasbeeh</p>
                  </a>

                  <a href="/weather" class="action-item" style="background: rgba(255, 255, 255, 0.15); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 12px; padding: 20px 15px; text-decoration: none; transition: all 0.3s ease; text-align: center;">
                    <div class="action-icon mb-2">
                      <i class="bi bi-cloud-sun" style="font-size: 2rem; color: #96CEB4;"></i>
                    </div>
                    <p class="action-label mb-0" style="color: #fff; font-weight: 500; font-size: 0.9rem;">Weather</p>
                  </a>

                  <a href="/pricing" class="action-item" style="background: rgba(255, 255, 255, 0.15); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 12px; padding: 20px 15px; text-decoration: none; transition: all 0.3s ease; text-align: center;">
                    <div class="action-icon mb-2">
                      <i class="bi bi-box" style="font-size: 2rem; color: #FECA57;"></i>
                    </div>
                    <p class="action-label mb-0" style="color: #fff; font-weight: 500; font-size: 0.9rem;">Packages</p>
                  </a>

                  <a href="/History" class="action-item" style="background: rgba(255, 255, 255, 0.15); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 12px; padding: 20px 15px; text-decoration: none; transition: all 0.3s ease; text-align: center;">
                    <div class="action-icon mb-2">
                      <i class="bi bi-clock-history" style="font-size: 2rem; color: #FF9FF3;"></i>
                    </div>
                    <p class="action-label mb-0" style="color: #fff; font-weight: 500; font-size: 0.9rem;">History</p>
                  </a>

                  <a href="/contactUs" class="action-item" style="background: rgba(255, 255, 255, 0.15); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 12px; padding: 20px 15px; text-decoration: none; transition: all 0.3s ease; text-align: center;">
                    <div class="action-icon mb-2">
                      <i class="bi bi-headset" style="font-size: 2rem; color: #54A0FF;"></i>
                    </div>
                    <p class="action-label mb-0" style="color: #fff; font-weight: 500; font-size: 0.9rem;">Support</p>
                  </a>

                  <a href="/Setting" class="action-item" style="background: rgba(255, 255, 255, 0.15); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 12px; padding: 20px 15px; text-decoration: none; transition: all 0.3s ease; text-align: center;">
                    <div class="action-icon mb-2">
 <i class="bi bi-person-circle" style="font-size: 2rem; color: #5F27CD;"></i>                    </div>
                    <p class="action-label mb-0" style="color: #fff; font-weight: 500; font-size: 0.9rem;">Profile</p>
                  </a>
                </div>
              </div>
            </div>
            <% } %>

            <style>
              .action-item:hover {
                transform: translateY(-5px);
                background: rgba(255, 255, 255, 0.25) !important;
                box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
              }

              .action-item .action-icon i {
                transition: all 0.3s ease;
                filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.2));
              }

              .action-item:hover .action-icon i {
                transform: scale(1.1);
                filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.3));
              }

              @media (max-width: 768px) {
                .actions-grid {
                  grid-template-columns: repeat(2, 1fr) !important;
                  gap: 10px;
                }

                .action-item {
                  padding: 15px 10px !important;
                }

                .action-icon i {
                  font-size: 1.5rem !important;
                }

                .action-label {
                  font-size: 0.8rem !important;
                }
              }
            </style>


          <!-- Sales Chart Start -->
          <div class="container-fluid p-4">
            <div class="row ">
                <!-- Website Visitors Card -->
               

                <!-- Revenue by Customer Type Card -->
                <div class="col-12 mb-4">
                    <div class="custom-card text-white" style="background-color: #1b263b; border: none; border-radius: 15px; padding: 20px; height: 400px; width: 100%;">
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <h5>Revenue by Customer Type</h5>
                            <h4><%= formattedTotalSales %> <span class="badge bg-success"><%= salesGrowth.toFixed(1) %>% <%= salesGrowth >= 0 ? '&#x2191;' : '&#x2193;' %></span></h4>
                        </div>

                        <div class="chart-container" style="position: relative; height: 250px;">
                            <canvas id="revenueChart"></canvas>
                        </div>

                        <div class="mt-4 d-flex justify-content-between align-items-center">
                            <div>
                                <span class="text-purple">&#9679; Current clients</span>
                                <span class="text-white">&#9679; Subscribers</span>
                                <span class="text-info">&#9679; New customers</span>
                            </div>

                        </div>
                    </div>
                </div>
            </div>
        </div>


        <!-- Products and Completed Tasks Section -->
<div class="container-fluid p-4">
    <div class="row justify-content-center">
        <div class="col-md-3 mb-4">
            <div class="custom-card text-white" style="background-color: #1b263b; border: none; border-radius: 15px; padding: 20px; height: 400px; overflow-y: auto;">
                <h5 class="mb-4">
                    <%= isAdmin ? 'All Teams' : 'My Team' %>
                    <% if (teams && teams.length > 0) { %>
                        <span class="badge bg-primary ms-2"><%= teams.length %></span>
                    <% } %>
                </h5>
             <% if (teams && teams.length > 0) { %>
                 <% if (isAdmin) { %>
                     <!-- Admin: Show all team members -->
                     <% teams.slice(-8).reverse().forEach(team => { %>
                     <div class="custom-product-item d-flex align-items-center mb-3">
                      <img src="https://img.icons8.com/3d-fluency/94/user-male--v4.png" alt="user-male--v4" class="me-3" style="width: 50px; height: 50px;"/>
                       <div>
                       <strong><%= team.name %></strong>
                          </div>
                       </div>
                       <% }); %>
                 <% } else { %>
                     <!-- User: Show their own team members with plan limit consideration -->
                     <% teams.forEach(team => { %>
                     <div class="custom-product-item d-flex align-items-center mb-3">
                      <img src="https://img.icons8.com/3d-fluency/94/user-male--v4.png" alt="user-male--v4" class="me-3" style="width: 50px; height: 50px;"/>
                       <div>
                       <strong><%= team.name %></strong>
                          </div>
                       </div>
                       <% }); %>
                     <!-- Show plan limit message for free users if they have limited access -->
                     <% if ((plan_name === 'FREE TRIAL' || plan_name === 'Free Trial') && teamCount > 5) { %>
                     <div class="alert alert-info mt-3 py-2" style="font-size: 0.8rem;">
                         <i class="bi bi-info-circle me-1"></i>
                         Showing 5 of <%= teamCount %> team members. Upgrade for full access.
                     </div>
                     <% } %>
                 <% } %>
                 <% } else { %>
                  <p>No team members added yet.</p>
                   <% } %>
                </div>
                    </div>

        <!-- Completed Tasks Section -->
        <div class="col-md-9 mb-4">
            <div class="custom-card text-white" style="background-color: #1b263b; border: none; border-radius: 15px; padding: 20px; height: 400px;">
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <div><i class="bi bi-clock"></i> Completed tasks over time</div>

                </div>
                <h2>257 <span style="color: #4caf50;">16.8% &#9650;</span></h2>
                <div style="position: relative; height: 250px;">
                    <canvas id="tasksChart"></canvas>
                </div>
            </div>
        </div>

    </div>
</div>


        <!-- Scripts -->
        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
        <script>
            // Initialize charts when DOM is ready
            document.addEventListener('DOMContentLoaded', function() {
                console.log('DOM Content Loaded - Initializing charts...');

                // Revenue Chart with Real Data
                let revenueChart;
                try {
                    console.log('Starting revenue chart initialization...');
                    const ctxRevenueElement = document.getElementById('revenueChart');
                    console.log('Revenue chart element found:', !!ctxRevenueElement);

                    if (!ctxRevenueElement) {
                        console.error('Revenue chart canvas not found');
                    } else {
                        const ctxRevenue = ctxRevenueElement.getContext('2d');

                        // Sample revenue data - you can replace this with real data
                        const revenueData = {
                            labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
                            datasets: [{
                                label: 'Daily Revenue',
                                data: [1200, 1900, 800, 1500, 2200, 1800, 1300],
                                backgroundColor: [
                                    '#c084fc',
                                    '#60a5fa',
                                    '#22d3ee',
                                    '#34d399',
                                    '#fbbf24',
                                    '#f87171',
                                    '#a78bfa'
                                ],
                                borderWidth: 0
                            }]
                        };

                        revenueChart = new Chart(ctxRevenue, {
                            type: 'bar',
                            data: revenueData,
                            options: {
                                responsive: true,
                                maintainAspectRatio: false,
                                scales: {
                                    y: {
                                        beginAtZero: true,
                                        ticks: { color: '#ffffff' },
                                        grid: { color: '#334155' }
                                    },
                                    x: {
                                        ticks: { color: '#ffffff' },
                                        grid: { display: false }
                                    }
                                },
                                plugins: {
                                    legend: { display: false },
                                    tooltip: {
                                        callbacks: {
                                            label: function(context) {
                                                return `$${context.raw}`;
                                            }
                                        }
                                    }
                                }
                            }
                        });
                        console.log('Revenue chart created successfully');
                    }
                } catch (error) {
                    console.error('Error initializing revenue chart:', error);
                    console.error('Error details:', error.message);
                }

                // Tasks Chart with Real Data (Daily Repair Completions)
                let tasksChart;
                try {
                    console.log('Starting tasks chart initialization...');
                    const ctxTasksElement = document.getElementById('tasksChart');
                    console.log('Tasks chart element found:', !!ctxTasksElement);

                    if (!ctxTasksElement) {
                        console.error('Tasks chart canvas not found');
                    } else {
                        const ctxTasks = ctxTasksElement.getContext('2d');

                        // Sample repair completion data - you can replace this with real data
                        const last7Days = ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'];
                        const repairCounts = [5, 3, 7, 2, 4, 1, 6];
                        const totalRepairs = repairCounts.reduce((sum, repairs) => sum + repairs, 0);
                        const avgRepairs = totalRepairs / 7;

                        // Update the display with real repair data
                        const tasksDisplay = document.querySelector('#tasksChart').closest('.custom-card').querySelector('h2');
                        if (tasksDisplay) {
                            const percentage = avgRepairs > 0 ? (((totalRepairs - avgRepairs) / avgRepairs) * 100).toFixed(1) : 0;
                            const growthSymbol = percentage > 0 ? 'â' : 'â';
                            const growthColor = percentage > 0 ? '#4caf50' : '#f44336';
                            tasksDisplay.innerHTML = `${totalRepairs} <span style="color: ${growthColor};">${percentage}% ${growthSymbol}</span>`;
                        }

                        tasksChart = new Chart(ctxTasks, {
                            type: 'line',
                            data: {
                                labels: last7Days,
                                datasets: [{
                                    label: 'Daily Completed Repairs',
                                    data: repairCounts,
                                    borderColor: '#00b4d8',
                                    backgroundColor: 'rgba(0, 180, 216, 0.2)',
                                    tension: 0.4,
                                    fill: true,
                                    borderWidth: 2
                                }]
                            },
                            options: {
                                responsive: true,
                                maintainAspectRatio: false,
                                scales: {
                                    y: {
                                        beginAtZero: true,
                                        ticks: { color: '#ffffff' },
                                        grid: { color: '#334155' }
                                    },
                                    x: {
                                        ticks: { color: '#ffffff' },
                                        grid: { display: false }
                                    }
                                },
                                plugins: {
                                    legend: { display: false },
                                    tooltip: {
                                        callbacks: {
                                            label: function(context) {
                                                return `${context.raw} repairs completed`;
                                            }
                                        }
                                    }
                                }
                            }
                        });
                        console.log('Tasks chart created successfully');
                        console.log('Chart data:', { labels: last7Days, data: repairCounts });
                    }
                } catch (error) {
                    console.error('Error initializing tasks chart:', error);
                }

                // Website Visitors Chart
                try {
                    console.log('Starting visitors chart initialization...');
                    const ctxVisitorsElement = document.getElementById('visitorsChart');
                    console.log('Visitors chart element found:', !!ctxVisitorsElement);

                    if (!ctxVisitorsElement) {
                        console.error('Visitors chart canvas not found');
                    } else {
                        const ctxVisitors = ctxVisitorsElement.getContext('2d');

                        const visitorsChart = new Chart(ctxVisitors, {
                            type: 'doughnut',
                            data: {
                                labels: ['Organic', 'Social', 'Direct'],
                                datasets: [{
                                    data: [80, 60, 50],
                                    backgroundColor: ['#4caf50', '#2196f3', '#00bcd4'],
                                    borderWidth: 0
                                }]
                            },
                            options: {
                                responsive: true,
                                maintainAspectRatio: false,
                                plugins: {
                                    legend: { display: false }
                                }
                            }
                        });
                        console.log('Visitors chart created successfully');
                    }
                } catch (error) {
                    console.error('Error initializing visitors chart:', error);
                }

                console.log('All charts initialization completed');
            });
        </script>

            <!-- Sales Chart End -->


            <!-- Recent Sales Start -->



                    <!-- Table Content -->
                    <div class="container-fluid p-4">
                        <div class="row justify-content-center">

                            <!-- Repair Queue Section -->
                            <div class="col-md-6 mb-4">
                                <div class="custom-card text-white" style="background-color: #1b263b; border: none; border-radius: 15px; padding: 20px; height: 400px; overflow: auto;">
                                    <div class="d-flex justify-content-between align-items-center mb-4 flex-s flex-wrap gap-2">
                                        <h4 class="mb-0">Repair</h4>
                                        <div class="d-flex align-items-center">
                                            <a href="/repair" class="btn btn-action btn-success"><i class="bi bi-tools"></i> Go to Repair Customer</a>

                                        </div>
                                    </div>

                                    <div class="table-responsive hide-on-small" style="overflow: auto; width: 100%;">
                                        <table class="table table-hover mb-0" style="background-color: transparent;">
                                            <thead class="text-center hide-on-small">
                                                <tr>
                                                    <th class="text-white">Full Name</th>
                                                    <th class="text-white">Product Name</th>
                                                    <th class="text-white">Price</th>
                                                    <th class="text-white">Status</th>
                                                </tr>
                                            </thead>
                                            <tbody class="text-center">
                                                <% if (products && products.length > 0) { %>
                                                    <% products.slice(0, 6).forEach(product => { %>
                                                        <tr >
                                                            <td class="text-white"><%= product.fullName %></td>
                                                            <td class="text-white"><%= product.brand %></td>
                                                            <td class="text-white"> <%= product.Price %></td>
                                                            <td>
                                                                <button class="btn btn-sm text-white <%= product.status %>">
                                                                    <%= product.status %>
                                                                </button>
                                                            </td>
                                                        </tr>
                                                    <% }) %>
                                                <% } else { %>
                                                    <tr>
                                                        <td colspan="4" class="text-center text-white">No repair products found.</td>
                                                    </tr>
                                                <% } %>
                                            </tbody>
                                        </table>
                                    </div>

                                        <!-- 1) Add this CSS (place in head or above the markup) -->
<style>
  /* Hide card list by default (desktop) */
  .product-cards { display: none; }

  /* On small screens hide the table and show cards */
  @media (max-width: 768px) {
    .product-cards { 
      display: flex !important; 
      flex-direction: column; 
      gap: 12px; 
      margin-top: 8px;
    }

    .product-card {
      background-color: rgba(255,255,255,0.03); /* subtle card bg; matches dark backgrounds */
      border: 1px solid rgba(255,255,255,0.06);
      border-radius: 10px;
      padding: 12px;
      box-shadow: 0 6px 18px rgba(0,0,0,0.35);
      color: #fff;
      width: 100%;
      box-sizing: border-box;
      word-break: break-word;
    }

    .product-card .card-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 8px;
      flex-wrap: wrap;
    }

    .product-card .card-col {
      display: flex;
      flex-direction: column;
      min-width: 0; /* allow text to wrap */
      margin-bottom: 4px;
    }

    .product-card .label {
      font-size: 12px;
      opacity: 0.7;
      margin-bottom: 4px;
    }

    .product-card .value {
      font-size: 14px;
      font-weight: 600;
      line-height: 1.2;
    }

    .product-card .status-wrap {
      margin-left: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .product-card .status-wrap .btn {
      padding: 6px 10px;
      font-size: 12px;
      border-radius: 6px;
      white-space: nowrap;
    }
  }

  /* Extra small screens: stack columns vertically */
  @media (max-width: 400px) {
    .product-card { padding: 10px; border-radius: 8px; }
    .product-card .card-row { flex-direction: column; align-items: flex-start; gap: 6px; }
    .product-card .status-wrap { align-self: stretch; width: 100%; display:flex; justify-content: flex-end; }
    .product-card .status-wrap .btn { width: auto; }
    .product-card .value { font-size: 13px; }
  }
  @media screen and (max-width:786px){
    .hide-on-small{
        display: none !important;
    }
  }
</style>

<!-- 2) Add this card markup RIGHT AFTER your existing table block (table remains unchanged) -->
<div class="product-cards">
  <% if (products && products.length > 0) { %>
    <% products.slice(0, 6).forEach(product => { %>
      <div class="product-card" aria-label="product-card-<%= product._id %>">
        <div class="card-row">
          <div class="card-col" style="flex:1;">
            <div class="label">Full Name</div>
            <div class="value"><%= product.fullName %></div>
          </div>

          <div class="card-col" style="flex:1;">
            <div class="label">Product Name</div>
            <div class="value"><%= product.brand %></div>
          </div>

          <div class="card-col" style="flex:0 0 auto; text-align:right;">
            <div class="label">Price</div>
            <div class="value"><%= product.Price %></div>
          </div>
        </div>

        <div class="card-row" style="margin-top:8px; align-items:center;">
          <div style="flex:1;">
            <!-- optional small note or id (remove if not needed) -->
            <div class="label" style="opacity:0.6;">Product ID</div>
            <div class="value" style="font-weight:400; font-size:12px;"><%= product._id %></div>
          </div>

          <div class="status-wrap">
            <!-- keep the original status button classes so your existing styles apply -->
            <button class="btn btn-sm text-white <%= product.status %>">
              <%= product.status %>
            </button>
          </div>
        </div>
      </div>
    <% }) %>
  <% } else { %>
    <div class="product-card">
      <div class="card-row">
        <div class="card-col">
          <div class="label">No repair products found.</div>
        </div>
      </div>
    </div>
  <% } %>
</div>


                                </div>
                            </div>

                            <!-- Recent Sales Section -->
                          <div class="col-md-6 mb-4">
  <div class="custom-card text-white" style="background-color: #1b263b; border: none; border-radius: 15px; padding: 20px; height: 400px;">
    <div class="d-flex justify-content-between align-items-center mb-4 flex-wrap gap-2>
      <h4 class="mb-0">Inventory</h4>
      <div class="d-flex align-items-center">
        <a href="/inventory" class="btn btn-action btn-success">
          <i class="bi bi-clipboard-data"></i> Go to Inventory
        </a>
      </div>
    </div>

    <!-- Scrollable table -->
    <div class="table-responsive" style="max-height: 300px; overflow-y: auto;">
      <table class="table table-hover mb-0" style="background-color: transparent;">
        <thead  class="hide-on-small" style="position: sticky; top: 0; background-color: #1b263b; z-index: 2;">
          <tr>
            <th class="text-white">Image</th>
            <th class="text-white">Product Name</th>
            <th class="text-white">Details</th>
            <th class="text-white">Sale Price</th>
            <th class="text-white">Retail Price</th>
          </tr>
        </thead>
        <tbody class="text-center">
          <% if (inventory && inventory.length > 0) { %>
            <% inventory.slice(0, 5).forEach(product => { %>
              <tr>
                <td>
                  <img src="/uploads/<%= product.device_image %>" alt="Device"
                       style="width: 40px; height: 40px; object-fit: cover; border-radius: 5px;">
                </td>
                <td class="text-white"><%= product.product_name %></td>
                <td class="text-white text-wrap" style="word-wrap: break-word;"><%= product.gadget_problem %></td>
                <td class="text-white"><%= product.Sale_Price %></td>
                <td class="text-white"><%= product.Retail_Price %></td>
              </tr>
            <% }) %>
          <% } else { %>
            <tr>
              <td colspan="5" class="text-center text-white">No sales records found.</td>
            </tr>
          <% } %>
        </tbody>
      </table>
    </div>
  </div>
</div>


                        </div>
                    </div>


      <!-- Recent Sales End -->
 <!-- footer -->
 <%- include('./par/footer.ejs') %>
  <!-- footer -->

</body>
  <!-- JavaScript Libraries -->
  <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/tempusdominus-bootstrap-4@5.39.0/build/js/tempusdominus-bootstrap-4.min.js"></script>

  <!-- Template Javascript -->
  <script src="js/main.js"></script>
</html>