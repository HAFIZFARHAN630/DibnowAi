<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Create Support Ticket - DIB-NOW</title>
    <link rel="icon" href="\images\DIB-NOW-512.png" type="image/x-icon">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css" rel="stylesheet">
    <link href="lib/tempusdominus/css/tempusdominus-bootstrap-4.min.css" rel="stylesheet" />
    <link href="bootstrap.css" rel="stylesheet">
    <link href="styles.css" rel="stylesheet">
    <link href="styles1.css" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      @keyframes fadeInUp {
        from { opacity: 0; transform: translateY(30px); }
        to { opacity: 1; transform: translateY(0); }
      }
      @keyframes slideIn {
        from { opacity: 0; transform: translateX(-20px); }
        to { opacity: 1; transform: translateX(0); }
      }
      @keyframes bounce {
        0%, 20%, 53%, 80%, 100% { transform: translate3d(0,0,0); }
        40%, 43% { transform: translate3d(0, -20px, 0); }
        70% { transform: translate3d(0, -10px, 0); }
        90% { transform: translate3d(0, -4px, 0); }
      }
      .fade-in-up { animation: fadeInUp 0.6s ease-out; }
      .slide-in { animation: slideIn 0.6s ease-out; }
      .glass-morphism { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); }
      .gradient-bg { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
      .form-input:focus { box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1); }
      .bounce-animation { animation: bounce 2s infinite; }
      .category-card {
        transition: all 0.3s ease;
        cursor: pointer;
      }
      .category-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 25px rgba(0,0,0,0.15);
      }
      .priority-indicator {
        position: relative;
        overflow: hidden;
      }
      .priority-indicator::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
        transition: left 0.5s;
      }
      .priority-indicator:hover::before {
        left: 100%;
      }
    </style>
</head>
<body class="bg-gradient-to-br from-indigo-50 via-purple-50 to-pink-50 min-h-screen">
<%- include('../par/sidebar.ejs') %>
<%- include('../par/header.ejs') %>

<!-- Hero Section -->
<div class="relative overflow-hidden bg-gradient-to-r  mt-10" style="background: linear-gradient(135deg, #0033cc 0%, #33ccff 100%);">
  <div class="absolute inset-0 bg-black opacity-10"></div>
  <div class="relative w-full mx-auto px-4 sm:px-6 lg:px-8 py-24">
    <div class="text-center">
      <h1 class="text-4xl md:text-6xl font-bold text-white mb-6 fade-in-up">
        <i class="fas fa-plus-circle mr-4 bounce-animation"></i>Create Support Ticket
      </h1>
      <p class="text-xl md:text-2xl text-indigo-100 mb-8 fade-in-up" style="animation-delay: 0.2s;">
        Report an issue and get help from our support team
      </p>
    </div>
  </div>
</div>



<!-- Create Ticket Form -->
<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 -mt-16 mb-12">
  <div class="glass-morphism rounded-3xl shadow-2xl border border-white/20 overflow-hidden fade-in-up" style="animation-delay: 0.3s;">
    <form id="ticketForm" method="POST" action="/save-ticket" class="p-8 space-y-8">
      <!-- Form Header -->
      <div class="text-center border-b border-gray-200 pb-8">
        <div class="w-20 h-20 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-full flex items-center justify-center mx-auto mb-6 shadow-lg">
          <i class="fas fa-edit text-3xl text-white"></i>
        </div>
        <h2 class="text-3xl font-bold text-gray-800 mb-4">Create Your Support Ticket</h2>
        <p class="text-lg text-gray-600 max-w-2xl mx-auto">Fill out the form below to report an issue, request assistance, or submit a support request. Our team will respond as quickly as possible.</p>
      </div>

      <!-- Ticket ID Generation -->
      <div class="bg-gradient-to-r from-indigo-50 to-purple-50 rounded-2xl p-6 border border-indigo-100">
        <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
          <div>
            <label class="block text-sm font-semibold text-indigo-700 uppercase tracking-wide mb-2">Ticket ID</label>
            <p class="text-sm text-indigo-600">Auto-generated unique identifier for your ticket</p>
          </div>
          <div class="flex items-center gap-3 flex-wrap">
            <input id="ticketId" name="ticketId" type="text" readonly
                   class="w-48 text-lg font-bold text-indigo-600 bg-white border-2 border-indigo-200 rounded-xl px-4 py-3 shadow-sm"
                   placeholder="TCK-YYYYMMDD-..." />
            <button type="button" onclick="generateTicketId()"
                    class="inline-flex items-center px-6 py-3 bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 text-white font-semibold rounded-xl shadow-lg hover:shadow-xl transform hover:-translate-y-1 transition-all duration-300">
              <i class="fas fa-magic mr-2"></i>Generate ID
            </button>
          </div>
        </div>
      </div>

      <!-- Form Fields -->
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
        <!-- Title -->
        <div class="lg:col-span-2">
          <label for="title" class="block text-sm font-bold text-gray-700 uppercase tracking-wide mb-3">
            <i class="fas fa-heading mr-2 text-indigo-600"></i>Ticket Title
          </label>
          <input id="title" name="title" type="text" required
                 class="w-full rounded-2xl border-2 border-gray-200 px-6 py-4 text-lg focus:outline-none focus:ring-4 focus:ring-indigo-500/20 focus:border-indigo-500 transition-all duration-300 bg-white shadow-sm hover:shadow-md"
                 placeholder="Brief description of your issue (e.g., Screen not powering after repair)">
          <p class="text-xs text-gray-500 mt-2">Keep it concise but descriptive</p>
        </div>

        <!-- Category Selection -->
        <div>
          <label for="category" class="block text-sm font-bold text-gray-700 uppercase tracking-wide mb-3">
            <i class="fas fa-tag mr-2 text-indigo-600"></i>Category
          </label>
          <div class="space-y-3">
            <div class="grid grid-cols-1 gap-2">
              <div class="category-card bg-gradient-to-r from-blue-50 to-indigo-50 border-2 border-blue-200 rounded-2xl p-4 hover:border-blue-400 focus-within:border-blue-500">
                <input type="radio" id="repair" name="category" value="Repair" class="sr-only" checked>
                <label for="repair" class="flex items-center cursor-pointer">
                  <div class="w-12 h-12 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-xl flex items-center justify-center mr-4">
                    <i class="fas fa-tools text-white text-lg"></i>
                  </div>
                  <div>
                    <h3 class="font-semibold text-gray-800">Repair</h3>
                    <p class="text-sm text-gray-600">Device repair issues</p>
                  </div>
                </label>
              </div>

              <div class="category-card bg-gradient-to-r from-green-50 to-emerald-50 border-2 border-green-200 rounded-2xl p-4 hover:border-green-400 focus-within:border-green-500">
                <input type="radio" id="inventory" name="category" value="Inventory" class="sr-only">
                <label for="inventory" class="flex items-center cursor-pointer">
                  <div class="w-12 h-12 bg-gradient-to-br from-green-500 to-emerald-600 rounded-xl flex items-center justify-center mr-4">
                    <i class="fas fa-boxes text-white text-lg"></i>
                  </div>
                  <div>
                    <h3 class="font-semibold text-gray-800">Inventory</h3>
                    <p class="text-sm text-gray-600">Stock and parts management</p>
                  </div>
                </label>
              </div>

              <div class="category-card bg-gradient-to-r from-purple-50 to-pink-50 border-2 border-purple-200 rounded-2xl p-4 hover:border-purple-400 focus-within:border-purple-500">
                <input type="radio" id="sales" name="category" value="Sales" class="sr-only">
                <label for="sales" class="flex items-center cursor-pointer">
                  <div class="w-12 h-12 bg-gradient-to-br from-purple-500 to-pink-600 rounded-xl flex items-center justify-center mr-4">
                    <i class="fas fa-shopping-cart text-white text-lg"></i>
                  </div>
                  <div>
                    <h3 class="font-semibold text-gray-800">Sales</h3>
                    <p class="text-sm text-gray-600">Sales and customer service</p>
                  </div>
                </label>
              </div>
            </div>
          </div>
        </div>

        <!-- Priority Selection -->
        <div>
          <label for="priority" class="block text-sm font-bold text-gray-700 uppercase tracking-wide mb-3">
            <i class="fas fa-exclamation-triangle mr-2 text-indigo-600"></i>Priority Level
          </label>
          <div class="space-y-3">
            <div class="priority-indicator bg-gradient-to-r from-green-50 to-emerald-50 border-2 border-green-200 rounded-2xl p-4 hover:border-green-400">
              <input type="radio" id="low" name="priority" value="Low" class="sr-only">
              <label for="low" class="flex items-center cursor-pointer">
                <div class="w-10 h-10 bg-gradient-to-br from-green-500 to-emerald-600 rounded-full flex items-center justify-center mr-4">
                  <i class="fas fa-check-circle text-white"></i>
                </div>
                <div>
                  <h3 class="font-semibold text-gray-800">Low</h3>
                  <p class="text-sm text-gray-600">General inquiries</p>
                </div>
              </label>
            </div>

            <div class="priority-indicator bg-gradient-to-r from-amber-50 to-orange-50 border-2 border-amber-200 rounded-2xl p-4 hover:border-amber-400">
              <input type="radio" id="medium" name="priority" value="Medium" class="sr-only" checked>
              <label for="medium" class="flex items-center cursor-pointer">
                <div class="w-10 h-10 bg-gradient-to-br from-amber-500 to-orange-600 rounded-full flex items-center justify-center mr-4">
                  <i class="fas fa-exclamation-circle text-white"></i>
                </div>
                <div>
                  <h3 class="font-semibold text-gray-800">Medium</h3>
                  <p class="text-sm text-gray-600">Standard support requests</p>
                </div>
              </label>
            </div>

            <div class="priority-indicator bg-gradient-to-r from-red-50 to-rose-50 border-2 border-red-200 rounded-2xl p-4 hover:border-red-400">
              <input type="radio" id="high" name="priority" value="High" class="sr-only">
              <label for="high" class="flex items-center cursor-pointer">
                <div class="w-10 h-10 bg-gradient-to-br from-red-500 to-rose-600 rounded-full flex items-center justify-center mr-4">
                  <i class="fas fa-exclamation-triangle text-white"></i>
                </div>
                <div>
                  <h3 class="font-semibold text-gray-800">High</h3>
                  <p class="text-sm text-gray-600">Urgent issues</p>
                </div>
              </label>
            </div>
          </div>
        </div>
      </div>

      <!-- Description -->
      <div>
        <label for="description" class="block text-sm font-bold text-gray-700 uppercase tracking-wide mb-3">
          <i class="fas fa-align-left mr-2 text-indigo-600"></i>Detailed Description
        </label>
        <textarea id="description" name="description" rows="8" required
                  class="w-full rounded-2xl border-2 border-gray-200 px-6 py-4 text-lg focus:outline-none focus:ring-4 focus:ring-indigo-500/20 focus:border-indigo-500 transition-all duration-300 bg-white shadow-sm resize-y hover:shadow-md"
                  placeholder="Please provide detailed information about your issue. Include any relevant details such as device model, error messages, steps to reproduce, or when the problem started."></textarea>
        <div class="flex items-center justify-between mt-3">
          <div class="text-sm text-gray-600">
            <i class="fas fa-info-circle mr-2 text-indigo-500"></i>
            Include device model, IMEI, or invoice details to help us assist you better
          </div>
          <div id="descCount" class="text-sm font-semibold text-indigo-600 bg-indigo-50 px-3 py-1 rounded-full">0 / 2000</div>
        </div>
      </div>

      <!-- File Attachment -->
      <div class="bg-gradient-to-r from-gray-50 to-slate-50 rounded-2xl p-6 border-2 border-dashed border-gray-300">
        <label for="attachment" class="block text-center cursor-pointer">
          <div class="flex flex-col items-center">
            <div class="w-16 h-16 bg-gradient-to-br from-gray-400 to-gray-600 rounded-full flex items-center justify-center mb-4">
              <i class="fas fa-cloud-upload-alt text-2xl text-white"></i>
            </div>
            <h3 class="text-lg font-semibold text-gray-700 mb-2">Attach Files (Optional)</h3>
            <p class="text-gray-600 mb-4">Upload photos, documents, or other files to help us understand your issue</p>
            <div class="flex items-center space-x-4 text-sm text-gray-500 flex-wrap justify-center">
              <span class="flex items-center">
                <i class="fas fa-image mr-2"></i>Images
              </span>
              <span class="flex items-center">
                <i class="fas fa-file-pdf mr-2"></i>PDFs
              </span>
              <span class="flex items-center">
                <i class="fas fa-file mr-2"></i>Documents
              </span>
            </div>
          </div>
          <input type="file" name="attachment" id="attachment" accept="image/*,.pdf,.doc,.docx" multiple class="hidden" />
        </label>
      </div>

      <!-- Action Buttons -->
      <div class="flex flex-col sm:flex-row items-center justify-between gap-4 pt-6 border-t border-gray-200">
        <button type="button" onclick="ticketFormReset()"
                class="w-full sm:w-auto inline-flex items-center justify-center px-8 py-4 bg-white border-2 border-gray-300 text-gray-700 font-semibold rounded-2xl hover:bg-gray-50 hover:border-gray-400 transform hover:-translate-y-1 transition-all duration-300 shadow-lg hover:shadow-xl">
          <i class="fas fa-undo mr-3"></i>Reset Form
        </button>

        <button type="submit"
                class="w-full sm:w-auto group relative inline-flex items-center justify-center px-8 py-4 bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 text-white font-bold rounded-2xl shadow-lg hover:shadow-2xl transform hover:-translate-y-1 transition-all duration-300 overflow-hidden">
          <div class="absolute inset-0 bg-gradient-to-r from-white/0 via-white/20 to-white/0 transform -skew-x-12 -translate-x-full group-hover:translate-x-full transition-transform duration-1000"></div>
          <span class="relative flex items-center">
            <i class="fas fa-paper-plane mr-3"></i>
            Create Support Ticket
            <i class="fas fa-arrow-right ml-3 group-hover:translate-x-1 transition-transform duration-300"></i>
          </span>
        </button>
      </div>

      <!-- Help Section -->
      <div class="bg-gradient-to-r from-blue-50 to-indigo-50 rounded-2xl p-6 border border-blue-100">
        <h3 class="text-lg font-semibold text-blue-800 mb-4 flex items-center">
          <i class="fas fa-question-circle mr-3 text-blue-600"></i>Need Help?
        </h3>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-sm">
          <div class="flex items-start space-x-3">
            <i class="fas fa-check-circle text-green-600 mt-1"></i>
            <div>
              <p class="font-semibold text-gray-800">Be Specific</p>
              <p class="text-gray-600">Include device model, error messages, and steps to reproduce</p>
            </div>
          </div>
          <div class="flex items-start space-x-3">
            <i class="fas fa-check-circle text-green-600 mt-1"></i>
            <div>
              <p class="font-semibold text-gray-800">Add Details</p>
              <p class="text-gray-600">The more information you provide, the faster we can help</p>
            </div>
          </div>
          <div class="flex items-start space-x-3">
            <i class="fas fa-check-circle text-green-600 mt-1"></i>
            <div>
              <p class="font-semibold text-gray-800">Upload Evidence</p>
              <p class="text-gray-600">Photos and documents help us understand your issue better</p>
            </div>
          </div>
        </div>
      </div>
    </form>
  </div>
</div>
   


<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="lib/tempusdominus/js/tempusdominus-bootstrap-4.min.js"></script>
<script src="js/main.js"></script>

<script>
  // Enhanced form functionality
  document.addEventListener('DOMContentLoaded', function() {
    // Character count for description
    const desc = document.getElementById('description');
    const descCount = document.getElementById('descCount');
    if (desc && descCount) {
      desc.addEventListener('input', () => {
        const length = desc.value.length;
        descCount.textContent = `${length} / 2000`;
        if (length > 1800) {
          descCount.className = 'text-sm font-semibold text-red-600 bg-red-50 px-3 py-1 rounded-full';
        } else if (length > 1500) {
          descCount.className = 'text-sm font-semibold text-amber-600 bg-amber-50 px-3 py-1 rounded-full';
        } else {
          descCount.className = 'text-sm font-semibold text-indigo-600 bg-indigo-50 px-3 py-1 rounded-full';
        }
      });
    }

    // Ticket ID generator with enhanced format
    window.generateTicketId = function() {
      const now = new Date();
      const pad = n => String(n).padStart(2,'0');
      const dateStr = `${now.getFullYear()}${pad(now.getMonth()+1)}${pad(now.getDate())}`;
      const timeStr = `${pad(now.getHours())}${pad(now.getMinutes())}${pad(now.getSeconds())}`;
      const randomStr = Math.random().toString(36).slice(2,6).toUpperCase();
      const id = `TCK-${dateStr}-${timeStr}-${randomStr}`;

      const ticketIdInput = document.getElementById('ticketId');
      if (ticketIdInput) {
        ticketIdInput.value = id;
        // Add animation effect
        ticketIdInput.style.transform = 'scale(1.05)';
        setTimeout(() => {
          ticketIdInput.style.transform = 'scale(1)';
        }, 200);
      }
    };

    // Enhanced form reset
    window.ticketFormReset = function() {
      const form = document.getElementById('ticketForm');
      if (form) {
        form.reset();
        // Reset ticket ID
        const ticketIdInput = document.getElementById('ticketId');
        if (ticketIdInput) ticketIdInput.value = '';

        // Reset character count
        if (desc && descCount) {
          descCount.textContent = '0 / 2000';
          descCount.className = 'text-sm font-semibold text-indigo-600 bg-indigo-50 px-3 py-1 rounded-full';
        }

        // Show success message
        showNotification('Form has been reset successfully!', 'success');
      }
    };

    // Category card interactions
    document.querySelectorAll('.category-card').forEach(card => {
      card.addEventListener('click', function() {
        const input = this.querySelector('input[type="radio"]');
        if (input) input.checked = true;
      });
    });

    // Priority indicator interactions
    document.querySelectorAll('.priority-indicator').forEach(indicator => {
      indicator.addEventListener('click', function() {
        const input = this.querySelector('input[type="radio"]');
        if (input) input.checked = true;
      });
    });

    // File upload enhancement
    const fileInput = document.getElementById('attachment');
    if (fileInput) {
      fileInput.addEventListener('change', function(e) {
        const files = e.target.files;
        if (files.length > 0) {
          const fileNames = Array.from(files).map(file => file.name).join(', ');
          showNotification(`${files.length} file(s) selected: ${fileNames}`, 'info');
        }
      });
    }

    // Form validation enhancement
    const ticketForm = document.getElementById('ticketForm');
    if (ticketForm) {
      ticketForm.addEventListener('submit', function(e) {
        const title = document.getElementById('title').value;
        const description = document.getElementById('description').value;
        const ticketId = document.getElementById('ticketId').value;

        if (!title.trim() || !description.trim() || !ticketId.trim()) {
          e.preventDefault();
          showNotification('Please fill in all required fields and generate a ticket ID', 'error');
          return false;
        }

        // Show loading state
        const submitBtn = this.querySelector('button[type="submit"]');
        const originalText = submitBtn.innerHTML;
        submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin mr-3"></i>Creating Ticket...';
        submitBtn.disabled = true;

        // Re-enable after 3 seconds (in case of network issues)
        setTimeout(() => {
          submitBtn.innerHTML = originalText;
          submitBtn.disabled = false;
        }, 3000);
      });
    }

    // Notification system
    function showNotification(message, type = 'info') {
      const notification = document.createElement('div');
      notification.className = `fixed top-4 right-4 px-6 py-4 rounded-2xl shadow-xl z-50 transform translate-x-full transition-transform duration-300 ${
        type === 'success' ? 'bg-green-500 text-white' :
        type === 'error' ? 'bg-red-500 text-white' :
        'bg-blue-500 text-white'
      }`;
      notification.innerHTML = `
        <div class="flex items-center">
          <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : 'info-circle'} mr-3"></i>
          <span>${message}</span>
        </div>
      `;

      document.body.appendChild(notification);

      // Animate in
      setTimeout(() => {
        notification.style.transform = 'translateX(0)';
      }, 100);

      // Remove after 4 seconds
      setTimeout(() => {
        notification.style.transform = 'translateX(full)';
        setTimeout(() => {
          notification.remove();
        }, 300);
      }, 4000);
    }

    // Auto-generate ticket ID on page load
    generateTicketId();

    // Add smooth scrolling for better UX
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
      anchor.addEventListener('click', function (e) {
        e.preventDefault();
        const target = document.querySelector(this.getAttribute('href'));
        if (target) {
          target.scrollIntoView({
            behavior: 'smooth',
            block: 'start'
          });
        }
      });
    });
  });
</script>
</body>
</html>